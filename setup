#!/usr/bin/env bash
set -eou pipefail

echo "ğŸ setting up folder for ty at /usr/"$USER""
sudo mkdir -p /usr/"$USER"
sudo cp ty /usr/"$USER"
sudo chmod +x /usr/"$USER"/ty
sudo cp parse-toml.py /usr/"$USER"

echo "ğŸ adding ty folder /usr/"$USER" to PATH in ~/.bashrc"
set +e
grep -q 'export PATH=\"/usr/\$USER:\$PATH\"' ~/.bashrc
grep_return=$?
set -e
if [[ $grep_return == 1 ]]; then
    echo "export PATH=\"/usr/\$USER:\$PATH\"" >> ~/.bashrc
fi

echo "ğŸ setting ENV variables for pip pyright in ~/.bashrc"
set +e
grep -q "PYRIGHT_PYTHON_FORCE_VERSION=\"latest\"" ~/.bashrc
grep_return=$?
set -e
if [[ $grep_return == 1 ]]; then
    echo "PYRIGHT_PYTHON_FORCE_VERSION=\"latest\"" >> ~/.bashrc
fi

set +H
printf "ğŸ success! restart terminal to use ty\n"
